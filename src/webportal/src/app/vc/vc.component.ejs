<section class='content-header'>
  <%= breadcrumb({ breadcrumbTitle: "Virtual Clusters" }) %>
</section>

<section class='content'>
  <div class='box'>
    <div class='box-body'>
      <% if (admin) { %>
      <button class="btn btn-success btn-lg add-vc-btn" id="virtualClustersBtn" onclick="virtualClusterShow()">Add Virtual Cluster</button>
      <% } %>
      <table id='vc-table' class='table table-bordered table-hover table-condensed' style='vertical-align:middle'>
        <thead>
          <tr>
            <th>Name</th>
            <th>Capacity</th>
            <th>Utilization</th>
            <th>Memory</th>
            <th>CPUs</th>
            <th>GPUs</th>
            <th>Active Jobs</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% for (let vcName in data) { %>
            <% if (specifiedVc && vcName !== specifiedVc) continue; %>
              <tr>
                <td>
                  <a href="virtual-clusters.html?vcName=<%= vcName %>"><%= vcName %></a>
                </td>
                <td>
                  <%= formatNumber(data[vcName]['capacity'], 2) %> %
                </td>
                <td>
                  <%= formatNumber(data[vcName]['capacity'] === 0 ? 0 : data[vcName]['usedCapacity'] / data[vcName]['capacity'] * 100, 2) %> %
                </td>
                <td>
                  <%= data[vcName]['resourcesUsed']['memory'] %> MB
                </td>
                <td>
                  <%= data[vcName]['resourcesUsed']['vCores'] %>
                </td>
                <td>
                  <%= data[vcName]['resourcesUsed']['GPUs'] %>
                </td>
                <td>
                  <%= data[vcName]['numJobs'] %>
                </td>
                <td width="8%">
                  <a onclick="changeVcSate('<%= vcName %>', '<%= data[vcName]['status'] %>')" class="state-vc state-<%= data[vcName]['status'].toLowerCase() %> <%= admin ? '' : 'state-vc-ordinary' %>">
                    <%= data[vcName]['status'].toLowerCase().replace(/( |^)[a-z]/g, (L) => L.toUpperCase()) %>
                    <% if (admin && vcName !== 'default') {%>
                      <span class="tips"></span>
                    <% } %>
                  </a>
                </td>
                <td>
                  <a href="view.html?vcName=<%= vcName %>">View Jobs</a>
                  &nbsp;&nbsp;|&nbsp;&nbsp;
                  <a href="<%= yarnWebPortalUri %>/cluster/scheduler?openQueues=<%= vcName %>" target="_blank">Go to Yarn Page</a>
                  <% if (admin) { %>
                    &nbsp;&nbsp;|&nbsp;&nbsp;
                    <a href="javscript:;" onclick="deleteVcItem('<%= vcName %>')" class="<%= vcName=='default' ? 'default' : '' %>">Delete</a>
                    &nbsp;&nbsp;|&nbsp;&nbsp;
                    <a href="javscript:;" onclick="editVcItem('<%= vcName %>', '<%= formatNumber(data[vcName]['capacity'], 2) %> %')" class="<%= vcName=='default' ? 'default' : '' %>">Edit</a>
                  <% } %>
                </td>
              </tr>
              <% } %>
        </tbody>
      </table>
    </div>
  </div>
  <%= modal({'vcDefault': data.default}) %>
</section>
